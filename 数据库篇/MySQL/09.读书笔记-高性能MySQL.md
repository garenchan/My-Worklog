# 读书笔记-高性能MySQL

- InnoDB的MVCC(多版本并发控制)，是通过在每行记录后面保存两个隐藏的列来实现的。这
两个列，一个保存了行的创建时间，一个保存行的过期时间(或删除时间)。当然存储的并不是
实际的时间值，而是系统的版本号(system version number)。每开始一个新的事务，系统版
本号都会自动递增。事务开始时刻的系统版本号会作为事务的版本号，用来和查询到的每行
记录的版本号进行比较。MVCC只在REPEATABLE READ和READ COMMITTED两个隔离级别下工作，
其他两个隔离级别都和MVCC不兼容，因为READ UNCOMMITTED总是读取最新的数据行，而不是
符合当前事务版本的数据行，而SERIALIZABLE则会对所有读取的行都加锁。

- InnoDB表示基于聚簇索引建立的，聚簇索引对主键查询有很高的性能。不过它的二级索引
(secondary index，非主键索引)中必须包含主键列，**所以如果主键列很大的话，其他的所有
索引都会很大**。因此，若表上的索引较多的话，主键应当尽可能的小。

- 选择数据类型的原则：
    - 更小的通常更好：占用更少的硬盘、内存和CPU缓存，处理时需要更少的CPU周期。
    - 简单就好：简单数据类型的操作通常需要更少的CPU周期。
    - 尽量避免NULL：查询更难优化，可为NULL的列使得索引、索引统计和值比较都更复杂。
