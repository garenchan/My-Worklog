# 中断-定时器


## 概念

- CPU定时器
- 键盘中断
- 键盘扫描码：scan code，是绝大多数计算机键盘向计算机发送的一项数据，用与报告哪些
建被按下或弹起


## 目标

**实现我们的第一个IRQ处理程序：CPU定时器和键盘**

现在我们就可以测试硬件中断了。


## 定时器

定时器配置起来非常简单。首先，我们将在`cpu/timer.h`中声明`init_timer()`，并在`cpu/timer.c`
中实现它。这只关系到计算时钟频率和将字节发送到适当端口。

现在我们将修复`kernel/utils.c int_to_ascii()`来以正确的顺序打印数字。为此，我们需
要实现`reverse()`和`strlen()`。

最后，返回`kernel/kernel.c`然后做两件事。再次开中断（非常重要！），然后初始化计时
器中断。

运行`make run`，你会看到时间在滴答。


## 键盘

键盘甚至更简单，但有一个缺点。PIC不会给我们发送按下的键的ASCII码，取而代之的是键
按下和弹起的扫描码，因此我们需要自行进行转换。

检查`drivers/keyboard.c`，其中有两个函数：回调和配置中断回调的初始化。新的`keyboard.h`
被创建来定义这些。

`keyboard.c`还有一个很长的表，用于将扫描码转换为ASCII码。目前，我们只实现了美国键
盘的一个简单子集。你可以在这里阅读更多[关于扫描码的信息](http://www.win.tue.nl/~aeb/linux/kbd/scancodes-1.html)。

我不知道你的情况，但我很激动！我们非常接近于构建一个简单的shell。在下一章中，我们
将对键盘输入做一些扩展。
