# HAProxy 初体验

## 场景描述

最近在虚拟机内访问IPV6网站时, 发现访问不了, 然后就想在一个有IPV6地址的物理机上部署

一个HTTP代理, 从而实现在IPV4-only的主机上访问IPV6网站的目的. 然后同事就推荐了HAProxy

这个高可用的TCP/HTTP代理软件

## 代理模式

* TCP(四层)代理

    使用TCP代理, 就相当于模拟四层转发, 非常的灵活, 可以支持几乎所有基于TCP的协议.
    
* HTTP(七层)代理

    使用HTTP代理, 会对转发的HTTP数据进行深度解析, 从而满足一些特殊的应用需求, 譬如
    
    粘滞会话
    
## 解决方案

* 如果需要借助HAProxy去访问多个IPV6网站, 使用TCP和HTTP代理模式都是可行的;

* 使用TCP代理时, 需要为每个网站关联一个独立的监听端口, 因为TCP模式只是简单的进

行数据转发, 所以如果多个网站关联同一个端口, 就没有办法进行区分;

* 使用HTTP代理时, 则可以将多个网站关联到同一个端口, 然后根据HTTP请求的PATH或HOST头

部来转发到相应的网站.


