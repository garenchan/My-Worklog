# OpenStack整合Hyper-V

* 目前我使用的是OpenStack Mitaka版本, 虚拟网络使用的Neutron VXLAN模式, 所以以下会主要针对这些版本进行描述

* 前一节有学习在Windows Server 2016上部署Hyper-V, 现在我们需要把这台服务器当做计算节点加入OpenStack中, 也就意味这你需要先部署好控制节点和网络节点


## 部署Hyper-V计算节点

由于OpenStack Nova组件的各个服务有调用到一些Posix上相关的接口或工具, 因此在Windows上是无法正常运行的;

不过有家公司Cloudbase提供了开源的针对Hyper-V的Nova组件, 我们下载它提供的安装包进行安装即可.

### 下载Hyper-V的Nova Compute安装包

[Hyper-V Nova Compute Installer下载地址](https://cloudbase.it/openstack-hyperv-driver/)

注: 由于Cloudbase只会提供版本较新的安装包, 如果你找不到合适你的安装包版本, 不妨从安装包文件的链接地址入手

    Newton[14.0.1]: https://cloudbase.it/downloads/HyperVNovaCompute_Newton_14_0_1.msi
    Ocata[15.0.0]: https://cloudbase.it/downloads/HyperVNovaCompute_Ocata_15_0_0.msi
    Pike[16.0.0]: https://cloudbase.it/downloads/HyperVNovaCompute_Pike_16_0_0_1.msi

通过已知的这些链接地址, 我们发现是有规律可循的, 我通过测试发现我要找的Mitaka版本安装包的链接地址为:

**https://cloudbase.it/downloads/HyperVNovaCompute_Mitaka_13_0_0.msi**

### 安装Nova Compute

* 双击安装包进行安装, 如果你尚未部署Hyper-V, 那么会提示你: "Please enable Hyper-V before installing this software".

* 安装过程十分简单, 可参考[Hyper-V Nova Compute安装说明](https://cloudbase.it/installing-openstack-nova-compute-on-hyper-v/).

* 如果你使用的Nuetron VLAN或者Flat模式, 那么到这里整个安装过程就宣告结束了, 意味着你可以通过Horizon或命令行来创建Hyper-V虚拟机了.

* 如果你使用的Nuetron VXLAN或者GRE模式, 那么还需要往下看, 原因如下:

    Nova Compute安装包实际上也会安装一个Neutron Hyper-V Agent, 顾名思义就是Neutron在Hyper-V节点上的代理, 而这个代理当前版本是不支持


## 